(this["webpackJsonpmms-github-issue-explorer"]=this["webpackJsonpmms-github-issue-explorer"]||[]).push([[0],{120:function(e){e.exports=JSON.parse('{"a":{"type":"git","url":"https://github.com/krasiyan/mms-github-issue-explorer"}}')},172:function(e,t,a){e.exports=a(225)},224:function(e,t,a){},225:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(17),i=a.n(o),s=a(37),l=a(36),c=a(18),u=a(21),m=a(271),g=function(e,t){var a=localStorage.getItem(e);return a?JSON.parse(a):t},p=function(e,t){var a=g(e,t),r=n.a.useState(a),o=Object(s.a)(r,2),i=o[0],l=o[1];return n.a.useEffect((function(){return localStorage.setItem(e,JSON.stringify(i))}),[i]),[i,l]},d=new RegExp("^https?://github.com/(?<owner>.+?)/(?<name>.+?)(?:/|$)"),h=a(122),b=a(155),f=a(3),E=a(249),v=a(251),y=a(252),O=a(253),C=a(254),N=a(255),S=a(62),j=a(256),k=a(257),I=Object(E.a)((function(e){return Object(v.a)({appBar:{color:"#fff",marginBottom:e.spacing(3)},title:{"text-transform":"none"}})})),w=function(){var e=I();return n.a.createElement(y.a,{position:"static",className:e.appBar},n.a.createElement(O.a,null,n.a.createElement(C.a,{justify:"space-between",alignItems:"center",container:!0},n.a.createElement(C.a,{item:!0},n.a.createElement(N.a,{"aria-label":"home",component:l.b,to:"/",color:"inherit",startIcon:n.a.createElement(j.a,{fontSize:"small"})},n.a.createElement(S.a,{variant:"h6",className:e.title},"MMS GitHub Issue Explorer"))),n.a.createElement(C.a,{item:!0},n.a.createElement(N.a,{component:l.b,to:"/settings",endIcon:n.a.createElement(k.a,null),color:"inherit"},"Settings")))))},R=a(276),x=a(272),T=a(258),L=Object(E.a)((function(e){return Object(v.a)({field:{marginTop:e.spacing(3),marginLeft:e.spacing(2),marginRight:e.spacing(2),width:"100%"}})})),H=function(e){var t=e.id,a=e.value,r=e.setValue,o=e.fieldRegex,i=e.label,l=e.placeholder,c=e.helperText,u=e.helperTextError,m=L(),g=function(){return o.test(a||"")},p=n.a.useState(!1),d=Object(s.a)(p,2),h=d[0],b=d[1];return n.a.createElement(R.a,{error:h&&!g(),className:m.field},n.a.createElement(x.a,{id:t,required:!0,error:h&&!g(),value:a,onChange:function(e){var t=e.target.value;return r(t)},onFocus:function(){return b(!0)},label:i,placeholder:l,helperText:h&&!g()&&u||c,InputLabelProps:{shrink:!0},inputProps:{spellCheck:"false"}}))},F=function(e){var t=e.githubConfig;return n.a.createElement("form",{noValidate:!0,autoComplete:"off"},n.a.createElement(C.a,{container:!0,item:!0,md:10,wrap:"wrap",justify:"space-between",alignItems:"flex-end"},n.a.createElement(H,{id:"githubRepository",value:t.repositoryUrl,setValue:t.setRepositoryUrl,fieldRegex:d,label:"GitHub repository",placeholder:"https://github.com/facebook/react",helperText:n.a.createElement("span",null,"Enter the full GitHub repository URL"),helperTextError:n.a.createElement("span",null,"Invalid GitHub repository - use the following format:",n.a.createElement("br",null),n.a.createElement("strong",null,"https://github.com/facebook/react"))}),n.a.createElement(H,{id:"githubToken",value:t.token,setValue:t.setToken,fieldRegex:new RegExp("(.+)"),label:"GitHub personal access token",placeholder:"token",helperText:n.a.createElement("span",null,"Create a personal access token on GitHub with the public_repo scope -"," ",n.a.createElement(T.a,{href:"https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/creating-a-personal-access-token",target:"_blank",rel:"noopener",color:"primary"},"official guide"))})))},P=a(121),U=a(269),M=a(274),$=a(268),A=a(68);function G(){var e=Object(A.a)(["\n  query SearchIssues($query: String!, $after: String) {\n    search(type: ISSUE, query: $query, last: 10, after: $after) {\n      edges {\n        node {\n          ... on Issue {\n            author {\n              login\n            }\n            comments {\n              totalCount\n            }\n            id\n            number\n            state\n            title\n            createdAt\n          }\n        }\n      }\n      pageInfo {\n        startCursor\n        hasPreviousPage\n        hasNextPage\n        endCursor\n      }\n    }\n  }\n"]);return G=function(){return e},e}var q=Object(u.gql)(G());function B(){var e=Object(A.a)(["\n  query GetIssue(\n    $githubRepositoryName: String!\n    $githubRepositoryOwner: String!\n    $issueNumber: Int!\n  ) {\n    repository(name: $githubRepositoryName, owner: $githubRepositoryOwner) {\n      issue(number: $issueNumber) {\n        id\n        number\n        state\n        title\n        url\n        author {\n          avatarUrl(size: 40)\n          login\n          url\n        }\n        bodyHTML\n        createdAt\n      }\n    }\n  }\n"]);return B=function(){return e},e}var z=Object(u.gql)(B());function Q(){var e=Object(A.a)(["\n  query GetIssueComments(\n    $githubRepositoryName: String!\n    $githubRepositoryOwner: String!\n    $issueNumber: Int!\n    $after: String\n  ) {\n    repository(name: $githubRepositoryName, owner: $githubRepositoryOwner) {\n      issue(number: $issueNumber) {\n        id\n        comments(first: 10, after: $after) {\n          edges {\n            node {\n              id\n              createdAt\n              author {\n                login\n                avatarUrl\n                url\n              }\n              bodyHTML\n            }\n          }\n          pageInfo {\n            startCursor\n            hasPreviousPage\n            hasNextPage\n            endCursor\n          }\n        }\n      }\n    }\n  }\n"]);return Q=function(){return e},e}var _,J=Object(u.gql)(Q());!function(e){e.OPEN="OPEN",e.CLOSED="CLOSED"}(_||(_={}));var D,V=a(161),W=a.n(V),K=a(275),X=a(259),Y=a(273),Z=a(107),ee=a(106),te=Object(E.a)((function(e){return Object(v.a)({root:{margin:"0 auto","text-align":"right"},issueStateFilter:{marginTop:e.spacing(2),marginBottom:e.spacing(2)},radioGreen:{color:Z.a[400]},radioRed:{color:ee.a[400]}})}));!function(e){e.open="open",e.closed="closed",e.both="both"}(D||(D={}));var ae=function(e){var t=e.issueStateFilter,a=e.setIssueStateFilter,r=e.issueTextFilter,o=e.setIssueTextFilter,i=te(),l=n.a.useState(""),c=Object(s.a)(l,2),u=c[0],m=c[1];return n.a.createElement("div",{className:i.root},n.a.createElement(W.a,{cancelOnEscape:!0,value:r,onChange:function(e){return m(e)},onRequestSearch:function(){return o(u)},onCancelSearch:function(){console.log("cancel"),o(""),m("")}}),n.a.createElement(R.a,{component:"fieldset",className:i.issueStateFilter},n.a.createElement(K.a,{row:!0,"aria-label":"issueStateFilter",name:"issueStateFilter",value:t,onChange:function(e){var t=e.target.value;return a(t)}},n.a.createElement(X.a,{value:"open",control:n.a.createElement(Y.a,{color:"default",className:i.radioGreen}),label:"Open"}),n.a.createElement(X.a,{value:"closed",control:n.a.createElement(Y.a,{color:"default",className:i.radioRed}),label:"Closed"}),n.a.createElement(X.a,{value:"both",control:n.a.createElement(Y.a,{color:"default"}),label:"Both"}))))},re=a(260),ne=a(261),oe=a(262),ie=a(263),se=a(264),le=a(265),ce=Object(E.a)((function(e){return Object(v.a)({root:{minWidth:275,margin:"0px auto ".concat(e.spacing(2),"px auto")},cardContent:{paddingLeft:0,paddingRight:0,"&:last-child":{paddingBottom:e.spacing(2)}},subTitle:{fontSize:12},issueOpenIcon:{color:Z.a[400]},issueClosedIcon:{color:ee.a[600]}})})),ue=function(e){var t=e.number,a=e.title,r=e.state,o=e.createdAt,i=e.authorLogin,s=e.totalCommentCount,c=ce();return n.a.createElement(re.a,{className:c.root,variant:"outlined"},n.a.createElement(ne.a,{component:l.b,to:"/".concat(t)},n.a.createElement(oe.a,{className:c.cardContent},n.a.createElement(C.a,{container:!0,justify:"space-between",alignItems:"stretch"},n.a.createElement(C.a,{item:!0,xs:2,md:1,container:!0,alignItems:"center",justify:"center"},"OPEN"===r?n.a.createElement(ie.a,{className:c.issueOpenIcon}):n.a.createElement(se.a,{className:c.issueClosedIcon})),n.a.createElement(C.a,{item:!0,xs:8,md:10,container:!0,justify:"space-around",alignItems:"flex-start",direction:"column"},n.a.createElement(S.a,{variant:"h6",component:"h2"},a),n.a.createElement(S.a,{className:c.subTitle,color:"textSecondary"},"#",t," opened on ",o," by ",i)),n.a.createElement(C.a,{item:!0,xs:2,md:1,container:!0,direction:"column",justify:"center",alignItems:"center"},n.a.createElement(le.a,null),n.a.createElement(S.a,{variant:"body2"},s))))))},me=a(266),ge=a(267),pe=Object(E.a)((function(){return Object(v.a)({root:{"text-align":"center"}})})),de=function(e){var t=e.loadMore,a=pe();return n.a.createElement("div",{className:a.root},n.a.createElement(me.a,{size:"medium",color:"primary",variant:"extended",onClick:function(){return t()}},n.a.createElement(ge.a,null),"Load more"))},he=a(120),be=function(e){var t=e.details;return n.a.createElement("div",null,n.a.createElement("br",null),n.a.createElement(S.a,{variant:"subtitle2"},"Error details:"),n.a.createElement(S.a,{variant:"overline"},t))},fe=function(){return n.a.createElement(M.a,{severity:"warning"},n.a.createElement($.a,null,"Missing GitHub access token"),"Please provide a GitHub personal access token in the"," ",n.a.createElement(l.b,{to:"/settings"},"settings page"),".")},Ee=function(){return n.a.createElement(M.a,{severity:"error"},n.a.createElement($.a,null,"Invalid GitHub access token"),"Please make sure you have the correct GitHub personal access token it in the"," ",n.a.createElement(l.b,{to:"/settings"},"settings")," and that it has the required scopes (i.e public_repo).")},ve=function(e){var t=e.details;return n.a.createElement(M.a,{severity:"error"},n.a.createElement($.a,null,"GraphQL error"),"A GraphQL error has occured - please make sure that the schema is up to date and that the"," ",n.a.createElement(T.a,{href:"".concat(he.a.url,"/actions"),target:"_blank",rel:"noopener",color:"primary"},"project's CI pipeline")," ","is passing.",n.a.createElement(be,{details:t}))},ye=function(e){var t=e.details;return n.a.createElement(M.a,{severity:"error"},n.a.createElement($.a,null,"An unknown error has occured"),"Please try again or open an issue in the"," ",n.a.createElement(T.a,{href:he.a.url,target:"_blank",rel:"noopener",color:"primary"},"project's repository"),n.a.createElement(be,{details:t}))},Oe=function(){return n.a.createElement(M.a,{severity:"error"},n.a.createElement($.a,null,"Invalid GitHub repository"),"Please set a valid repository URL in the"," ",n.a.createElement(l.b,{to:"/settings"},"settings"))},Ce=function(e){var t,a=e.error;if(a.graphQLErrors.length>0)return n.a.createElement(ve,{details:a.message});if(a.networkError&&"statusCode"in a.networkError&&401===a.networkError.statusCode)return"result"in a.networkError&&"Bad credentials"===(null===(t=a.networkError.result)||void 0===t?void 0:t.message)?n.a.createElement(Ee,null):n.a.createElement(fe,null);return n.a.createElement(ye,{details:a.message})},Ne=function(e){var t=e.githubRepositoryOwner,a=e.githubRepositoryName,r=e.issueStateFilter,o=e.issueTextFilter,i=["repo:".concat(t,"/").concat(a),"is:issue","sort:created",o].concat(Object(P.a)(r===D.open?["is:open"]:[]),Object(P.a)(r===D.closed?["is:closed"]:[])),s=Object(u.useQuery)(q,{variables:{query:i.join(" ")}}),l=s.loading,c=s.error,m=s.data,g=s.fetchMore,p=s.startPolling,d=s.stopPolling;if(n.a.useEffect((function(){var e,t;if(!l&&m&&(null===m||void 0===m||null===(e=m.search)||void 0===e||null===(t=e.edges)||void 0===t?void 0:t.length)>0)return p(3e4),function(){d()}}),[l,m,p,d]),l)return n.a.createElement(U.a,null);if(c)return n.a.createElement(Ce,{error:c});if(!m||0===m.search.edges.length)return n.a.createElement(M.a,{severity:"info"},n.a.createElement($.a,null,"No issues found"));return n.a.createElement(n.a.Fragment,null,m.search.edges.map((function(e){var t=e.node,a=t.id,r=t.number,o=t.title,i=t.state,s=t.createdAt,l=t.author.login,c=t.comments.totalCount;return n.a.createElement(ue,Object.assign({number:r,title:o,state:i,createdAt:s,authorLogin:l,totalCommentCount:c},{key:a}))})),m.search.pageInfo.hasNextPage&&n.a.createElement(de,{loadMore:function(){g({variables:{after:m.search.pageInfo.endCursor}})}}))},Se=function(e){var t=e.githubConfig,a=n.a.useState(D.both),r=Object(s.a)(a,2),o=r[0],i=r[1],l=n.a.useState(""),c=Object(s.a)(l,2),u=c[0],m=c[1];return n.a.createElement(n.a.Fragment,null,n.a.createElement(ae,{issueStateFilter:o,setIssueStateFilter:i,issueTextFilter:u,setIssueTextFilter:m}),n.a.createElement(Ne,{githubRepositoryName:t.repositoryName,githubRepositoryOwner:t.repositoryOwner,issueStateFilter:o,issueTextFilter:u}))},je=a(270),ke=a(277),Ie=a(278),we=a(145),Re=a(162),xe=a.n(Re),Te=a(163),Le=a.n(Te),He=(a(223),function(e){var t=e.bodyHTML;return n.a.createElement("div",{className:"markdown-body"},xe()(Le.a.sanitize(t)))}),Fe=Object(E.a)((function(e){return Object(v.a)({root:{marginBottom:e.spacing(1)},header:{"& > .MuiCardHeader-avatar":{marginRight:e.spacing(1)}},avatarRoot:{width:e.spacing(5),height:e.spacing(5)},avatarComment:{width:e.spacing(3),height:e.spacing(3)},issueStatusChip:{color:"white",marginLeft:e.spacing(1)},issueStatusChipOpen:{backgroundColor:Z.a[400]},issueStatusChipClosed:{backgroundColor:ee.a[600]},issueStatusIcon:{color:"white"}})})),Pe=function(e){var t=Fe();return n.a.createElement(re.a,{className:t.root,variant:"outlined"},n.a.createElement(je.a,{avatar:n.a.createElement(ke.a,{alt:e.authorLogin,src:e.authorAvatarUrl,className:e.isRootComment?t.avatarRoot:t.avatarComment},e.authorLogin.substr(0,1)),title:e.isRootComment?e.issueTitle:void 0,titleTypographyProps:{variant:"h5"},subheader:n.a.createElement(C.a,{container:!0,alignItems:"center"},n.a.createElement("span",null,n.a.createElement(T.a,{href:e.authorUrl,target:"_blank",rel:"noopener"},e.authorLogin)," ","on ",e.createdAt),e.isRootComment&&"OPEN"===e.issueStatus?n.a.createElement(Ie.a,{label:"Open",size:"small",icon:n.a.createElement(ie.a,{className:t.issueStatusIcon}),className:"".concat(t.issueStatusChip," ").concat(t.issueStatusChipOpen)}):"CLOSED"===e.issueStatus?n.a.createElement(Ie.a,{label:"Closed",size:"small",icon:n.a.createElement(se.a,{className:t.issueStatusIcon}),className:"".concat(t.issueStatusChip," ").concat(t.issueStatusChipClosed)}):void 0),action:e.isRootComment?n.a.createElement(we.a,{"aria-label":"settings",component:T.a,href:e.issueUrl,target:"_blank",rel:"noopener",color:"primary"},n.a.createElement(C.a,{container:!0,direction:"column",alignItems:"center"},n.a.createElement(j.a,null),n.a.createElement(S.a,{variant:"body2"},"#",e.issueNumber))):void 0,className:t.header}),n.a.createElement(oe.a,null,n.a.createElement(He,{bodyHTML:e.bodyHTML})))},Ue=function(e){var t=e.githubConfig,a=e.issueNumber,r=Object(u.useQuery)(J,{variables:{githubRepositoryName:t.repositoryName,githubRepositoryOwner:t.repositoryOwner,issueNumber:a}}),o=r.loading,i=r.error,s=r.data,l=r.fetchMore;if(o)return n.a.createElement(U.a,null);if(i)return n.a.createElement(Ce,{error:i});if(!s||0===s.repository.issue.comments.edges.length)return n.a.createElement(M.a,{severity:"info"},n.a.createElement($.a,null,"No comments yets"));return n.a.createElement(n.a.Fragment,null,s.repository.issue.comments.edges.map((function(e){var t=e.node,a=t.author,r=a.login,o=a.url,i=a.avatarUrl,s=t.bodyHTML,l=t.createdAt,c=t.id;return n.a.createElement(Pe,Object.assign({isRootComment:!1,createdAt:l,authorLogin:r,authorUrl:o,authorAvatarUrl:i,bodyHTML:s},{key:c}))})),s.repository.issue.comments.pageInfo.hasNextPage&&n.a.createElement(de,{loadMore:function(){l({variables:{after:s.repository.issue.comments.pageInfo.endCursor}})}}))},Me=Object(E.a)((function(e){return Object(v.a)({root:{paddingBottom:e.spacing(5)}})})),$e=function(e){var t=e.githubConfig,a=Me(),r=Object(c.f)().issueNumber,o=parseInt(r,10),i=Object(u.useQuery)(z,{variables:{githubRepositoryOwner:t.repositoryOwner,githubRepositoryName:t.repositoryName,issueNumber:o}}),s=i.loading,l=i.error,m=i.data;if(s)return n.a.createElement(U.a,null);if(l)return n.a.createElement(Ce,{error:l});if(!m||!m.repository.issue)return n.a.createElement(M.a,{severity:"warning"},n.a.createElement($.a,null,"Issue not found"));var g=m.repository.issue;return n.a.createElement("div",{className:a.root},n.a.createElement(Pe,{isRootComment:!0,issueNumber:o,issueStatus:g.state,issueTitle:g.title,issueUrl:g.url,createdAt:g.createdAt,authorLogin:g.author.login,authorUrl:g.author.url,authorAvatarUrl:g.author.avatarUrl,bodyHTML:g.bodyHTML}),n.a.createElement(Ue,{githubConfig:t,issueNumber:o}))},Ae=(a(224),function(e){var t=e.githubConfig,a=e.children;return t.repositoryOwner&&t.repositoryName?t.token?n.a.createElement(n.a.Fragment,null,a):n.a.createElement(fe,null):n.a.createElement(Oe,null)}),Ge=function(){var e,t,a=function(){var e=Object(u.createHttpLink)({uri:"https://api.github.com/graphql"}),t=Object(b.a)((function(e,t){var a=t.headers,r=g("githubToken","");return{headers:Object(h.a)(Object(h.a)({},a),{},{authorization:r?"bearer ".concat(r):""})}}));return new u.ApolloClient({link:t.concat(e),cache:new u.InMemoryCache({typePolicies:{User:{keyFields:["login"]},Repository:{keyFields:[["id"]]},Issue:{fields:{comments:Object(f.H)([["issueNumber"]])}},Query:{fields:{search:Object(f.H)(["query"])}}}}),connectToDevTools:!0})}(),r=p("githubRepositoryUrl","https://github.com/facebook/react"),o=Object(s.a)(r,2),i=o[0],E=o[1],v=p("githubToken",""),y=Object(s.a)(v,2),O=y[0],C=y[1],N=i.match(d),S={token:O,setToken:C,repositoryUrl:i,setRepositoryUrl:E,repositoryOwner:null===N||void 0===N||null===(e=N.groups)||void 0===e?void 0:e.owner,repositoryName:null===N||void 0===N||null===(t=N.groups)||void 0===t?void 0:t.name};return n.a.useEffect((function(){a.resetStore()}),[i,O]),n.a.createElement(u.ApolloProvider,{client:a},n.a.createElement(l.a,{basename:"/mms-github-issue-explorer"},n.a.createElement(w,null),n.a.createElement(m.a,{maxWidth:"md"},n.a.createElement(c.c,null,n.a.createElement(c.a,{path:"/settings"},n.a.createElement(F,{githubConfig:S})),n.a.createElement(c.a,{path:"/:issueNumber"},n.a.createElement(Ae,{githubConfig:S},n.a.createElement($e,{githubConfig:S}))),n.a.createElement(c.a,{path:"/"},n.a.createElement(Ae,{githubConfig:S},n.a.createElement(Se,{githubConfig:S})))))))};i.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(Ge,null)),document.getElementById("root"))}},[[172,1,2]]]);
//# sourceMappingURL=main.42c9e94d.chunk.js.map